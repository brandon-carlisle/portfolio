---
import { getCollection, type CollectionEntry, render } from "astro:content";
import Layout from "@/layouts/Layout.astro";

export const prerender = true;

export async function getStaticPaths() {
  const projects = await getCollection("projects", ({ data }) => {
    return data.published;
  });

  const orderedProjects = [...projects].sort(
    (a, b) => a.data.order - b.data.order,
  );
  return orderedProjects.map((project) => ({
    params: { slug: project.data.slug },
    props: { project },
  }));
}

interface Props {
  project: CollectionEntry<"projects">;
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<Layout title={project.data.title} description={project.data.description}>
  <article class="animate-fade-in">
    <div class="mb-8">
      <a
        href="/projects"
        class="inline-flex items-center gap-2 text-neutral-400 hover:text-emerald-400 transition-colors duration-300 mb-6"
        rel="prefetch"
      >
        <span
          class="group-hover:-translate-x-1 transition-transform duration-300"
          >&larr;</span
        >
        Back to projects
      </a>
    </div>

    <div
      class="prose prose-invert md:prose-lg max-w-none
        prose-headings:text-neutral-200 prose-headings:font-semibold prose-headings:tracking-tight
        prose-p:text-neutral-300 prose-p:leading-relaxed
        prose-a:text-emerald-400 prose-a:no-underline hover:prose-a:text-emerald-300 prose-a:transition-colors
        prose-strong:text-neutral-200
        prose-code:text-emerald-400 prose-code:bg-neutral-900/50 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded
        prose-img:rounded-xl prose-img:w-full prose-img:shadow-2xl"
    >
      <Content />
    </div>
  </article>
</Layout>
